{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Tima\\\\Desktop\\\\AutoParts\\\\frontend\\\\src\\\\pages\\\\Tasks.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useParams } from 'react-router-dom';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Tasks() {\n  _s();\n  const [tasks, setTasks] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const {\n    taskId\n  } = useParams();\n  const [logModal, setLogModal] = useState({\n    open: false,\n    log: '',\n    taskId: null\n  });\n  useEffect(() => {\n    fetchTasks();\n  }, []);\n  const fetchTasks = async () => {\n    try {\n      const response = await axios.get('http://localhost:8000/api/parsing-tasks/', {\n        headers: {\n          'Authorization': `Token ${localStorage.getItem('token')}`\n        }\n      });\n      setTasks(response.data);\n    } catch (err) {\n      setError('Ошибка при загрузке задач');\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    let interval;\n    if (taskId) {\n      interval = setInterval(async () => {\n        try {\n          const response = await axios.get(`http://localhost:8000/api/parsing-tasks/${taskId}/status/`, {\n            headers: {\n              'Authorization': `Token ${localStorage.getItem('token')}`\n            }\n          });\n          setTasks(prevTasks => prevTasks.map(task => task.id === parseInt(taskId) ? {\n            ...task,\n            ...response.data\n          } : task));\n          if (response.data.status === 'completed' || response.data.status === 'failed') {\n            clearInterval(interval);\n          }\n        } catch (err) {\n          console.error('Ошибка при обновлении статуса:', err);\n        }\n      }, 5000);\n    } else {\n      // Автообновление списка задач, если есть незавершённые задачи\n      interval = setInterval(async () => {\n        try {\n          const response = await axios.get('http://localhost:8000/api/parsing-tasks/', {\n            headers: {\n              'Authorization': `Token ${localStorage.getItem('token')}`\n            }\n          });\n          setTasks(response.data);\n        } catch (err) {\n          // ignore\n        }\n      }, 5000);\n    }\n    return () => {\n      if (interval) {\n        clearInterval(interval);\n      }\n    };\n  }, [taskId]);\n  const clearTasks = async () => {\n    if (window.confirm('Вы уверены, что хотите очистить все задачи?')) {\n      try {\n        await fetch('http://localhost:8000/api/parsing-tasks/clear/', {\n          method: 'DELETE',\n          headers: {\n            'Authorization': `Token ${localStorage.getItem('token')}`,\n            'Content-Type': 'application/json'\n          }\n        });\n        fetchTasks(); // Обновляем список задач после очистки\n      } catch (err) {\n        console.error('Ошибка при очистке задач:', err);\n        setError('Не удалось очистить задачи');\n      }\n    }\n  };\n  const handleShowLog = async id => {\n    setLogModal({\n      open: true,\n      log: 'Загрузка...',\n      taskId: id\n    });\n    try {\n      const response = await axios.get(`http://localhost:8000/api/parsing-tasks/${id}/log/`, {\n        headers: {\n          'Authorization': `Token ${localStorage.getItem('token')}`\n        }\n      });\n      setLogModal({\n        open: true,\n        log: response.data.log || 'Лог пуст',\n        taskId: id\n      });\n    } catch (err) {\n      setLogModal({\n        open: true,\n        log: 'Ошибка при загрузке лога',\n        taskId: id\n      });\n    }\n  };\n  const handleCloseLog = () => {\n    setLogModal({\n      open: false,\n      log: '',\n      taskId: null\n    });\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-center items-center h-64\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }, this);\n  }\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center text-red-600\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-7xl mx-auto\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-end mb-4\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: clearTasks,\n        className: \"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors\",\n        children: \"\\u041E\\u0447\\u0438\\u0441\\u0442\\u0438\\u0442\\u044C \\u0432\\u0441\\u0435 \\u0437\\u0430\\u0434\\u0430\\u0447\\u0438\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white shadow overflow-hidden sm:rounded-md\",\n      children: /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"divide-y divide-gray-200\",\n        children: tasks.map(task => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"px-4 py-4 sm:px-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm font-medium text-blue-600 truncate\",\n                  children: [\"\\u0417\\u0430\\u0434\\u0430\\u0447\\u0430 #\", task.id]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 150,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"ml-2 flex-shrink-0 flex\",\n                  children: /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: `px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${task.status === 'completed' ? 'bg-green-100 text-green-800' : task.status === 'failed' ? 'bg-red-100 text-red-800' : task.status === 'in_progress' ? 'bg-yellow-100 text-yellow-800' : 'bg-gray-100 text-gray-800'}`,\n                    children: task.status === 'completed' ? 'Завершено' : task.status === 'failed' ? 'Ошибка' : task.status === 'in_progress' ? 'В процессе' : 'Ожидает'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 154,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 153,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 149,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ml-2 flex-shrink-0 flex\",\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm text-gray-500\",\n                  children: new Date(task.created_at).toLocaleString()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 168,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 167,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 148,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-2 sm:flex sm:justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"sm:flex\",\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"flex items-center text-sm text-gray-500\",\n                  children: task.file\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 175,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 19\n              }, this), task.progress > 0 && task.progress < 100 && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-2 flex items-center text-sm text-gray-500 sm:mt-0\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-full bg-gray-200 rounded-full h-2.5\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"bg-blue-600 h-2.5 rounded-full\",\n                    style: {\n                      width: `${task.progress}%`\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 182,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 181,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"ml-2\",\n                  children: [task.progress, \"%\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 187,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 180,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 17\n            }, this), task.error_message && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-2 text-sm text-red-600\",\n              children: task.error_message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-2\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"text-xs text-gray-500 underline hover:text-blue-600\",\n                onClick: () => handleShowLog(task.id),\n                children: \"\\u041F\\u043E\\u043A\\u0430\\u0437\\u0430\\u0442\\u044C \\u043B\\u043E\\u0433 \\u0437\\u0430\\u0434\\u0430\\u0447\\u0438\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 17\n            }, this), task.status === 'completed' && task.result_files && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-2 flex flex-col gap-1\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-xs text-gray-500\",\n                children: \"\\u0424\\u0430\\u0439\\u043B\\u044B \\u0440\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442\\u043E\\u0432:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 208,\n                columnNumber: 21\n              }, this), Object.entries(task.result_files).map(([site, path]) => /*#__PURE__*/_jsxDEV(\"a\", {\n                href: `/${path.replace(/\\\\/g, '/')}`,\n                className: \"text-sm font-medium text-blue-600 hover:text-blue-500\",\n                download: true,\n                children: [site === 'autopiter' && 'Autopiter', site === 'emex' && 'Emex', site === 'armtek' && 'Armtek', !['autopiter', 'emex', 'armtek'].includes(site) && site]\n              }, site, true, {\n                fileName: _jsxFileName,\n                lineNumber: 210,\n                columnNumber: 23\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 19\n            }, this), task.status === 'completed' && task.result_file && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-2\",\n              children: /*#__PURE__*/_jsxDEV(\"a\", {\n                href: task.result_file,\n                className: \"text-sm font-medium text-blue-600 hover:text-blue-500\",\n                download: true,\n                children: \"\\u0421\\u043A\\u0430\\u0447\\u0430\\u0442\\u044C \\u0440\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 226,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 15\n          }, this)\n        }, task.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 7\n    }, this), logModal.open && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-lg shadow-lg max-w-2xl w-full p-6 relative\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"absolute top-2 right-2 text-gray-400 hover:text-gray-700\",\n          onClick: handleCloseLog,\n          children: \"\\xD7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-lg font-bold mb-2\",\n          children: [\"\\u041B\\u043E\\u0433 \\u0437\\u0430\\u0434\\u0430\\u0447\\u0438 #\", logModal.taskId]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n          className: \"bg-gray-100 p-2 rounded text-xs max-h-96 overflow-auto whitespace-pre-wrap\",\n          children: logModal.log\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 12\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 10\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 8\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 133,\n    columnNumber: 5\n  }, this);\n}\n_s(Tasks, \"niQLKRBLsz53wRuHwxLqQT21yGA=\", false, function () {\n  return [useParams];\n});\n_c = Tasks;\nexport default Tasks;\nvar _c;\n$RefreshReg$(_c, \"Tasks\");","map":{"version":3,"names":["React","useState","useEffect","useParams","axios","jsxDEV","_jsxDEV","Tasks","_s","tasks","setTasks","loading","setLoading","error","setError","taskId","logModal","setLogModal","open","log","fetchTasks","response","get","headers","localStorage","getItem","data","err","interval","setInterval","prevTasks","map","task","id","parseInt","status","clearInterval","console","clearTasks","window","confirm","fetch","method","handleShowLog","handleCloseLog","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","Date","created_at","toLocaleString","file","progress","style","width","error_message","result_files","Object","entries","site","path","href","replace","download","includes","result_file","_c","$RefreshReg$"],"sources":["C:/Users/Tima/Desktop/AutoParts/frontend/src/pages/Tasks.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport axios from 'axios';\r\n\r\nfunction Tasks() {\r\n  const [tasks, setTasks] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const { taskId } = useParams();\r\n  const [logModal, setLogModal] = useState({ open: false, log: '', taskId: null });\r\n\r\n  useEffect(() => {\r\n    fetchTasks();\r\n  }, []);\r\n\r\n  const fetchTasks = async () => {\r\n    try {\r\n      const response = await axios.get('http://localhost:8000/api/parsing-tasks/', {\r\n        headers: {\r\n          'Authorization': `Token ${localStorage.getItem('token')}`\r\n        }\r\n      });\r\n      setTasks(response.data);\r\n    } catch (err) {\r\n      setError('Ошибка при загрузке задач');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    let interval;\r\n    if (taskId) {\r\n      interval = setInterval(async () => {\r\n        try {\r\n          const response = await axios.get(`http://localhost:8000/api/parsing-tasks/${taskId}/status/`, {\r\n            headers: {\r\n              'Authorization': `Token ${localStorage.getItem('token')}`\r\n            }\r\n          });\r\n          \r\n          setTasks(prevTasks => \r\n            prevTasks.map(task => \r\n              task.id === parseInt(taskId) \r\n                ? { ...task, ...response.data }\r\n                : task\r\n            )\r\n          );\r\n\r\n          if (response.data.status === 'completed' || response.data.status === 'failed') {\r\n            clearInterval(interval);\r\n          }\r\n        } catch (err) {\r\n          console.error('Ошибка при обновлении статуса:', err);\r\n        }\r\n      }, 5000);\r\n    } else {\r\n      // Автообновление списка задач, если есть незавершённые задачи\r\n      interval = setInterval(async () => {\r\n        try {\r\n          const response = await axios.get('http://localhost:8000/api/parsing-tasks/', {\r\n            headers: {\r\n              'Authorization': `Token ${localStorage.getItem('token')}`\r\n            }\r\n          });\r\n          setTasks(response.data);\r\n        } catch (err) {\r\n          // ignore\r\n        }\r\n      }, 5000);\r\n    }\r\n\r\n    return () => {\r\n      if (interval) {\r\n        clearInterval(interval);\r\n      }\r\n    };\r\n  }, [taskId]);\r\n\r\n  const clearTasks = async () => {\r\n    if (window.confirm('Вы уверены, что хотите очистить все задачи?')) {\r\n      try {\r\n        await fetch('http://localhost:8000/api/parsing-tasks/clear/', {\r\n          method: 'DELETE',\r\n          headers: {\r\n            'Authorization': `Token ${localStorage.getItem('token')}`,\r\n            'Content-Type': 'application/json'\r\n          }\r\n        });\r\n        fetchTasks(); // Обновляем список задач после очистки\r\n      } catch (err) {\r\n        console.error('Ошибка при очистке задач:', err);\r\n        setError('Не удалось очистить задачи');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleShowLog = async (id) => {\r\n    setLogModal({ open: true, log: 'Загрузка...', taskId: id });\r\n    try {\r\n      const response = await axios.get(`http://localhost:8000/api/parsing-tasks/${id}/log/`, {\r\n        headers: {\r\n          'Authorization': `Token ${localStorage.getItem('token')}`\r\n        }\r\n      });\r\n      setLogModal({ open: true, log: response.data.log || 'Лог пуст', taskId: id });\r\n    } catch (err) {\r\n      setLogModal({ open: true, log: 'Ошибка при загрузке лога', taskId: id });\r\n    }\r\n  };\r\n\r\n  const handleCloseLog = () => {\r\n    setLogModal({ open: false, log: '', taskId: null });\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex justify-center items-center h-64\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"text-center text-red-600\">\r\n        {error}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-7xl mx-auto\">\r\n      <div className=\"flex justify-end mb-4\">\r\n        <button\r\n          onClick={clearTasks}\r\n          className=\"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors\"\r\n        >\r\n          Очистить все задачи\r\n        </button>\r\n      </div>\r\n      \r\n      <div className=\"bg-white shadow overflow-hidden sm:rounded-md\">\r\n        <ul className=\"divide-y divide-gray-200\">\r\n          {tasks.map((task) => (\r\n            <li key={task.id}>\r\n              <div className=\"px-4 py-4 sm:px-6\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"flex items-center\">\r\n                    <p className=\"text-sm font-medium text-blue-600 truncate\">\r\n                      Задача #{task.id}\r\n                    </p>\r\n                    <div className=\"ml-2 flex-shrink-0 flex\">\r\n                      <p className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${\r\n                        task.status === 'completed' ? 'bg-green-100 text-green-800' :\r\n                        task.status === 'failed' ? 'bg-red-100 text-red-800' :\r\n                        task.status === 'in_progress' ? 'bg-yellow-100 text-yellow-800' :\r\n                        'bg-gray-100 text-gray-800'\r\n                      }`}>\r\n                        {task.status === 'completed' ? 'Завершено' :\r\n                         task.status === 'failed' ? 'Ошибка' :\r\n                         task.status === 'in_progress' ? 'В процессе' :\r\n                         'Ожидает'}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"ml-2 flex-shrink-0 flex\">\r\n                    <p className=\"text-sm text-gray-500\">\r\n                      {new Date(task.created_at).toLocaleString()}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"mt-2 sm:flex sm:justify-between\">\r\n                  <div className=\"sm:flex\">\r\n                    <p className=\"flex items-center text-sm text-gray-500\">\r\n                      {task.file}\r\n                    </p>\r\n                  </div>\r\n                  {(task.progress > 0 && task.progress < 100) && (\r\n                    <div className=\"mt-2 flex items-center text-sm text-gray-500 sm:mt-0\">\r\n                      <div className=\"w-full bg-gray-200 rounded-full h-2.5\">\r\n                        <div\r\n                          className=\"bg-blue-600 h-2.5 rounded-full\"\r\n                          style={{ width: `${task.progress}%` }}\r\n                        ></div>\r\n                      </div>\r\n                      <span className=\"ml-2\">{task.progress}%</span>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                {task.error_message && (\r\n                  <div className=\"mt-2 text-sm text-red-600\">\r\n                    {task.error_message}\r\n                  </div>\r\n                )}\r\n                {/* Кнопка для показа лога */}\r\n                <div className=\"mt-2\">\r\n                  <button\r\n                    className=\"text-xs text-gray-500 underline hover:text-blue-600\"\r\n                    onClick={() => handleShowLog(task.id)}\r\n                  >\r\n                    Показать лог задачи\r\n                  </button>\r\n                </div>\r\n                {/* Ссылки на все выгруженные файлы */}\r\n                {task.status === 'completed' && task.result_files && (\r\n                  <div className=\"mt-2 flex flex-col gap-1\">\r\n                    <span className=\"text-xs text-gray-500\">Файлы результатов:</span>\r\n                    {Object.entries(task.result_files).map(([site, path]) => (\r\n                      <a\r\n                        key={site}\r\n                        href={`/${path.replace(/\\\\/g, '/')}`}\r\n                        className=\"text-sm font-medium text-blue-600 hover:text-blue-500\"\r\n                        download\r\n                      >\r\n                        {site === 'autopiter' && 'Autopiter'}\r\n                        {site === 'emex' && 'Emex'}\r\n                        {site === 'armtek' && 'Armtek'}\r\n                        {!['autopiter','emex','armtek'].includes(site) && site}\r\n                      </a>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n                {task.status === 'completed' && task.result_file && (\r\n                  <div className=\"mt-2\">\r\n                    <a\r\n                      href={task.result_file}\r\n                      className=\"text-sm font-medium text-blue-600 hover:text-blue-500\"\r\n                      download\r\n                    >\r\n                      Скачать результат\r\n                    </a>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n     {/* Модальное окно для лога */}\r\n     {logModal.open && (\r\n       <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40\">\r\n         <div className=\"bg-white rounded-lg shadow-lg max-w-2xl w-full p-6 relative\">\r\n           <button\r\n             className=\"absolute top-2 right-2 text-gray-400 hover:text-gray-700\"\r\n             onClick={handleCloseLog}\r\n           >\r\n             ×\r\n           </button>\r\n           <h2 className=\"text-lg font-bold mb-2\">Лог задачи #{logModal.taskId}</h2>\r\n           <pre className=\"bg-gray-100 p-2 rounded text-xs max-h-96 overflow-auto whitespace-pre-wrap\">\r\n             {logModal.log}\r\n           </pre>\r\n         </div>\r\n       </div>\r\n     )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Tasks;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}